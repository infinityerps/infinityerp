
OB=OB||{};OB.RoleInheritance={execute:function(params,view){var roleId,selection=params.button.contextView.viewGrid.getSelectedRecords(),callback;callback=function(rpcResponse,data,rpcRequest){isc.clearPrompt();if(data.message.severity==='success'){view.view.messageBar.setMessage(isc.OBMessageBar.TYPE_SUCCESS,data.message.title,data.message.text);}else{view.view.messageBar.setMessage(isc.OBMessageBar.TYPE_ERROR,data.message.title,data.message.text);}
view.view.refresh();};OB.RemoteCallManager.call(params.actionHandler,{roles:params.roles},{},callback);isc.showPrompt(OB.I18N.getLabel('OBUIAPP_PROCESSING')+isc.Canvas.imgHTML({src:OB.Styles.LoadingPrompt.loadingImage.src}));},recalculatePermissions:function(params,view){var isTemplate,message,messagetxt,name,selection=params.button.contextView.viewGrid.getSelectedRecords(),roles=[];for(i=0;i<selection.length;i++){roles.push(selection[i].id);};params.roles=roles;params.actionHandler='org.openbravo.role.inheritance.RecalculatePermissionsHandler';if(selection.length==1){name=selection[0].name;isTemplate=selection[0].template;if(isTemplate){message='RecalculateTemplateRolePermissions';}else{message='RecalculateRolePermissions';}
messagetxt=OB.I18N.getLabel(message,[name]);}else{messagetxt=OB.I18N.getLabel('RecalculateMultipleRolesPermissions');}
isc.confirm(messagetxt,{isModal:true,showModalMask:true,title:OB.I18N.getLabel('RecalculatePermissions')},function(clickedOK){if(clickedOK){OB.RoleInheritance.execute(params,view);}});}}